@using PEngine.Services
@inject UserService service

@if (_currentUser is null)
{
    <AsyncNavLink Href="/login">Login</AsyncNavLink>
}
else
{
    <AsyncNavLink Href="/my-page">@_currentUser.Name</AsyncNavLink>
}

@code
{
    private User? _currentUser;

    [Parameter]
    public bool IsAuthenticated { get; set; }

    protected override void OnAfterRender(bool firstRender)
    {
        if (ShouldRender())
        {
            _currentUser = IsAuthenticated ? service.GetCurrentUser() : null;
            StateHasChanged();
        }
        
        base.OnAfterRender(firstRender);
    }
}